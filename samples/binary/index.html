<!DOCTYPE HTML>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <title>Citrus Framework</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="generator" content="Citrus 4.6.0">
  <meta name="description" content="Citrus Framework Website"/>
  <meta name="author" content="ConSol Software GmbH"/>
  <link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="Citrus Integration Tests" />
  <link rel="alternate" type="application/atom+xml" title="Recent commits to Citrus master branch" href="https://github.com/citrusframework/citrus/commits/master.atom">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic,900">
  <link rel="stylesheet" href="/css/screen.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <!--[if lt IE 9]>
  <script src="/js/html5shiv.min.js"></script>
  <script src="/js/respond.min.js"></script>
  <![endif]-->
</head>


<body class="wrap">
  <header role="banner">
  <nav class="mobile-nav show-on-mobiles">
    <ul>
  <li class="hide-on-mobiles">
    <img src="/img/brand-logo.png" alt="Citrus"><span class="brand">Citrus</span>
  </li>
  <li class="">
    <a href="/"><i class="fa fa-home"></i></a>
  </li>
  <li class="">
    <a href="/projects/">Projects</a>
  </li>
  <li class="">
    <a href="/endpoints/">Endpoints</a>
  </li>
  <li class="">
    <a href="/runtimes/">Runtimes</a>
  </li>
  <li class="">
    <a href="/docs/documentation/">Doc<span class="hide-on-mobiles">umentation</span><span class="show-on-mobiles">s</span></a>
  </li>
  <li class="current">
    <a href="/samples/">Samples</a>
  </li>
  <li class="">
    <a href="/news/">News<span class="hide-on-mobiles"> &amp; Blog</span></a>
  </li>
  <li class="">
    <a href="/help/"><span class="show-on-mobiles"><i class="fa fa-help"></i></span><span class="hide-on-mobiles">Help</span></a>
  </li>
  <li class="hide-on-mobiles">
    <a href="https://github.com/citrusframework/citrus" target="_blank"><i class="fa fa-github"></i>  GitHub</a>
  </li>
</ul>

  </nav>
  <div class="grid">
    <nav class="main-nav whole hide-on-mobiles">
      <ul>
  <li class="hide-on-mobiles">
    <img src="/img/brand-logo.png" alt="Citrus"><span class="brand">Citrus</span>
  </li>
  <li class="">
    <a href="/"><i class="fa fa-home"></i></a>
  </li>
  <li class="">
    <a href="/projects/">Projects</a>
  </li>
  <li class="">
    <a href="/endpoints/">Endpoints</a>
  </li>
  <li class="">
    <a href="/runtimes/">Runtimes</a>
  </li>
  <li class="">
    <a href="/docs/documentation/">Doc<span class="hide-on-mobiles">umentation</span><span class="show-on-mobiles">s</span></a>
  </li>
  <li class="current">
    <a href="/samples/">Samples</a>
  </li>
  <li class="">
    <a href="/news/">News<span class="hide-on-mobiles"> &amp; Blog</span></a>
  </li>
  <li class="">
    <a href="/help/"><span class="show-on-mobiles"><i class="fa fa-help"></i></span><span class="hide-on-mobiles">Help</span></a>
  </li>
  <li class="hide-on-mobiles">
    <a href="https://github.com/citrusframework/citrus" target="_blank"><i class="fa fa-github"></i>  GitHub</a>
  </li>
</ul>

    </nav>
  </div>
</header>


    <section class="samples">
    <div class="grid">

      <div class="samples-nav-mobile unit whole show-on-mobiles">
  <select onchange="if (this.value) window.location.href=this.value">
    <option value="">Navigate the samples…</option>
    <option value="/samples/">Overview</option>
    <option value="/samples/todo-app/">TodoList app</option>
    <option value="/samples/run/">Running</option>
    
    
    <option value="/samples/annotation-config/">sample-annotation-config</option>
    
    <option value="/samples/reporting/">sample-reporting</option>
    
    <option value="/samples/javaconfig/">sample-javaconfig</option>
    
    <option value="/samples/kubernetes/">sample-kubernetes</option>
    
    <option value="/samples/docker/">sample-docker</option>
    
    <option value="/samples/apache-camel/">sample-camel-context</option>
    
    <option value="/samples/jbang/">sample-jbang</option>
    
    <option value="/samples/cucumber/">sample-cucumber</option>
    
    <option value="/samples/quarkus/">sample-quarkus</option>
    
    <option value="/samples/selenium/">sample-selenium</option>
    
    <option value="/samples/http/">sample-http</option>
    
    <option value="/samples/sftp/">sample-sftp</option>
    
    <option value="/samples/soap-attachment/">sample-soap-attachment</option>
    
    <option value="/samples/http-basic-auth/">sample-http-basic-auth</option>
    
    <option value="/samples/ftp/">sample-ftp</option>
    
    <option value="/samples/dynamic-endpoints/">sample-dynamic-endpoints</option>
    
    <option value="/samples/scp/">sample-scp</option>
    
    <option value="/samples/https/">sample-https</option>
    
    <option value="/samples/soap-mtom/">sample-soap-mtom</option>
    
    <option value="/samples/jdbc/">sample-jdbc</option>
    
    <option value="/samples/jms/">sample-jms</option>
    
    <option value="/samples/mail/">sample-mail</option>
    
    <option value="/samples/openapi/">sample-swagger</option>
    
    <option value="/samples/wsdl/">sample-wsdl</option>
    
    <option value="/samples/kafka/">sample-kafka</option>
    
    <option value="/samples/soap/">sample-soap</option>
    
    <option value="/samples/rmi/">sample-rmi</option>
    
    <option value="/samples/soap-wsaddressing/">sample-soap-wsaddressing</option>
    
    <option value="/samples/soap-static-response/">sample-soap-static-response</option>
    
    <option value="/samples/http-static-response/">sample-http-static-response</option>
    
    <option value="/samples/http-loadtest/">sample-http-loadtest</option>
    
    <option value="/samples/soap-wssecurity/">sample-soap-wssecurity</option>
    
    <option value="/samples/soap-ssl/">sample-soap-ssl</option>
    
    <option value="/samples/behavior/">sample-behavior</option>
    
    <option value="/samples/dictionaries/">sample-dictionaries</option>
    
    <option value="/samples/gradle/">sample-gradle</option>
    
    <option value="/samples/message-store/">sample-message-store</option>
    
    <option value="/samples/junit/">sample-junit</option>
    
    <option value="/samples/testng/">sample-testng</option>
    
    <option value="/samples/dataprovider/">sample-dataprovider</option>
    
    <option value="/samples/junit5/">sample-junit5</option>
    
    <option value="/samples/xml/">sample-xml</option>
    
    <option value="/samples/hamcrest/">sample-hamcrest</option>
    
    <option value="/samples/json/">sample-json</option>
    
    <option value="/samples/oxm/">sample-oxm</option>
    
    <option value="/samples/xhtml/">sample-xhtml</option>
    
    <option value="/samples/databind/">sample-databind</option>
    
    <option value="/samples/http-form-data/">sample-http-form-data</option>
    
    <option value="/samples/sql/">sample-sql</option>
    
    <option value="/samples/binary/">sample-binary</option>
    
  </select>
</div>


      <div class="unit four-fifths">
        <article>
  <h2>
    
    <i class="fa fa-binary" style="width: 1em;height: 1em;"></i>
    
    
    Binary sample
    <a href="/samples/binary/" class="permalink" title="Permalink">∞</a>
  </h2>
  <div class="right">
    
    
    <a href="https://github.com/citrusframework/citrus-samples/blob/master/sample-binary" target="_blank">
      <i class="fa fa-pencil"></i> View source code
    </a>
    
  </div>
  <span class="post-category">
    <span class="label">
      samples
    </span>
  </span>
  <div class="post-content">
    <p>This sample demonstrates how Citrus handles binary message content. The sample send some binary content to a JMS queue destination and receives
that same content in a next step from the JMS destination. Read more about this in <a href="https://citrusframework.org/citrus/reference/html#binary-message-validation">reference guide</a></p>

<h2 id="objectives">Objectives</h2>

<p>We demonstrate the binary content handling by using binary JMS messages.</p>

<p>The Citrus project needs a JMS connection factory that is defined in the Spring application context as bean:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Bean</span>
<span class="kd">public</span> <span class="n">ConnectionFactory</span> <span class="nf">connectionFactory</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">ActiveMQConnectionFactory</span><span class="o">(</span><span class="s">"tcp://localhost:61616"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>We use ActiveMQ as message broker so we use the respective connection factory implementation here. The message broker is automatically
started with the Maven build lifecycle.</p>

<p>No we can send some content as binary message to the JMS queue destination.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">send</span><span class="o">(</span><span class="n">todoJmsEndpoint</span><span class="o">)</span>
    <span class="o">.</span><span class="na">messageType</span><span class="o">(</span><span class="n">MessageType</span><span class="o">.</span><span class="na">BINARY</span><span class="o">)</span>
    <span class="o">.</span><span class="na">message</span><span class="o">(</span><span class="k">new</span> <span class="n">DefaultMessage</span><span class="o">(</span><span class="s">"{ \"title\": \"${todoName}\", \"description\": \"${todoDescription}\", \"done\": ${done}}"</span><span class="o">.</span><span class="na">getBytes</span><span class="o">()));</span>
</code></pre></div></div>

<p>The sample uses the <code class="highlighter-rouge">getBytes()</code> method of Java String class in order to get binary content as byte array. Citrus will automatically
take care on this binary content by creating a binary JMS message.</p>

<p>Now the next step is to receive the same binary message in Citrus in order to do some validation. We can receive the binary message content
by marking the message type as <code class="highlighter-rouge">BINARY</code>. As binary content is not comparable we use a special message validator implementation that converts the
binary content to a String representation for comparison.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">receive</span><span class="o">(</span><span class="n">todoJmsEndpoint</span><span class="o">)</span>
    <span class="o">.</span><span class="na">messageType</span><span class="o">(</span><span class="n">MessageType</span><span class="o">.</span><span class="na">BINARY</span><span class="o">)</span>
    <span class="o">.</span><span class="na">validator</span><span class="o">(</span><span class="k">new</span> <span class="n">BinaryMessageValidator</span><span class="o">())</span>
    <span class="o">.</span><span class="na">payload</span><span class="o">(</span><span class="s">"{ \"title\": \"${todoName}\", \"description\": \"${todoDescription}\", \"done\": ${done}}"</span><span class="o">);</span>
</code></pre></div></div>

<p>The binary message validator implementation is very simple and performs String equals for validation:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">class</span> <span class="nc">BinaryMessageValidator</span> <span class="kd">extends</span> <span class="n">AbstractMessageValidator</span><span class="o">&lt;</span><span class="n">DefaultValidationContext</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">validateMessage</span><span class="o">(</span><span class="n">Message</span> <span class="n">receivedMessage</span><span class="o">,</span> <span class="n">Message</span> <span class="n">controlMessage</span><span class="o">,</span>
                                <span class="n">TestContext</span> <span class="n">context</span><span class="o">,</span> <span class="n">DefaultValidationContext</span> <span class="n">validationContext</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">isTrue</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">receivedMessage</span><span class="o">.</span><span class="na">getPayload</span><span class="o">(</span><span class="kt">byte</span><span class="o">[].</span><span class="na">class</span><span class="o">))</span>
                <span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">controlMessage</span><span class="o">.</span><span class="na">getPayload</span><span class="o">(</span><span class="kt">byte</span><span class="o">[].</span><span class="na">class</span><span class="o">))),</span> <span class="s">"Binary message validation failed!"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supportsMessageType</span><span class="o">(</span><span class="n">String</span> <span class="n">messageType</span><span class="o">,</span> <span class="n">Message</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">messageType</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">MessageType</span><span class="o">.</span><span class="na">BINARY</span><span class="o">.</span><span class="na">name</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">Class</span> <span class="nf">getRequiredValidationContextType</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">DefaultValidationContext</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This way you can implement your own validation as you know best how to handle the binary content.</p>

<p>We can also use base64 encoding for handling binary data in Citrus. The base64 encoding can be used to process the binary content
with basic comparison in <code class="highlighter-rouge">BINARY_BASE64</code> message validator:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">receive</span><span class="o">(</span><span class="n">todoJmsEndpoint</span><span class="o">)</span>
    <span class="o">.</span><span class="na">messageType</span><span class="o">(</span><span class="n">MessageType</span><span class="o">.</span><span class="na">BINARY_BASE64</span><span class="o">)</span>
    <span class="o">.</span><span class="na">payload</span><span class="o">(</span><span class="s">"citrus:encodeBase64('{ \"title\": \"${todoName}\", \"description\": \"${todoDescription}\" }')"</span><span class="o">);</span>
</code></pre></div></div>

<p>Just use the <code class="highlighter-rouge">encodeBase64</code> function in Citrus to provide the expected payload content. Citrus will automatically convert the received 
binary content to base64 encoded Strings then for you.</p>

<h2 id="run">Run</h2>

<p>You can run the sample on your localhost in order to see Citrus in action. Read the instructions <a href="/samples/run/">how to run</a> the sample.</p>


  </div>
</article>

      </div>

      <div class="unit one-fifth hide-on-mobiles">
  <aside>
    <h4>Samples</h4>
    <ul>
      <li class="">
        <a href="/samples/">Overview</a>
      </li>
      <li class="">
        <a href="/samples/todo-app">TodoList application</a>
      </li>
      <li class="">
        <a href="/samples/run">Running</a>
      </li>
    </ul>
    <h4>Configuration</h4>
    <ul style="margin-top: 5px;">
      
      

      
      
      <li class="">
        <a href="/samples/annotation-config/">sample-annotation-config</a>
      </li>
      
      
      <li class="">
        <a href="/samples/reporting/">sample-reporting</a>
      </li>
      
      
      <li class="">
        <a href="/samples/javaconfig/">sample-javaconfig</a>
      </li>
      
      
    </ul>

    <h4>Connectors</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/kubernetes/">sample-kubernetes</a>
      </li>
      
      
      <li class="">
        <a href="/samples/docker/">sample-docker</a>
      </li>
      
      
    </ul>

    <h4>Demo</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/apache-camel/">sample-camel-context</a>
      </li>
      
      
      <li class="">
        <a href="/samples/jbang/">sample-jbang</a>
      </li>
      
      
      <li class="">
        <a href="/samples/cucumber/">sample-cucumber</a>
      </li>
      
      
      <li class="">
        <a href="/samples/quarkus/">sample-quarkus</a>
      </li>
      
      
      <li class="">
        <a href="/samples/selenium/">sample-selenium</a>
      </li>
      
      
    </ul>

    <h4>Endpoints</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/http/">sample-http</a>
      </li>
      
      
      <li class="">
        <a href="/samples/sftp/">sample-sftp</a>
      </li>
      
      
      <li class="">
        <a href="/samples/soap-attachment/">sample-soap-attachment</a>
      </li>
      
      
      <li class="">
        <a href="/samples/http-basic-auth/">sample-http-basic-auth</a>
      </li>
      
      
      <li class="">
        <a href="/samples/ftp/">sample-ftp</a>
      </li>
      
      
      <li class="">
        <a href="/samples/dynamic-endpoints/">sample-dynamic-endpoints</a>
      </li>
      
      
      <li class="">
        <a href="/samples/scp/">sample-scp</a>
      </li>
      
      
      <li class="">
        <a href="/samples/https/">sample-https</a>
      </li>
      
      
      <li class="">
        <a href="/samples/soap-mtom/">sample-soap-mtom</a>
      </li>
      
      
      <li class="">
        <a href="/samples/jdbc/">sample-jdbc</a>
      </li>
      
      
      <li class="">
        <a href="/samples/jms/">sample-jms</a>
      </li>
      
      
      <li class="">
        <a href="/samples/mail/">sample-mail</a>
      </li>
      
      
      <li class="">
        <a href="/samples/openapi/">sample-swagger</a>
      </li>
      
      
      <li class="">
        <a href="/samples/wsdl/">sample-wsdl</a>
      </li>
      
      
      <li class="">
        <a href="/samples/kafka/">sample-kafka</a>
      </li>
      
      
      <li class="">
        <a href="/samples/soap/">sample-soap</a>
      </li>
      
      
      <li class="">
        <a href="/samples/rmi/">sample-rmi</a>
      </li>
      
      
      <li class="">
        <a href="/samples/soap-wsaddressing/">sample-soap-wsaddressing</a>
      </li>
      
      
      <li class="">
        <a href="/samples/soap-static-response/">sample-soap-static-response</a>
      </li>
      
      
      <li class="">
        <a href="/samples/http-static-response/">sample-http-static-response</a>
      </li>
      
      
      <li class="">
        <a href="/samples/http-loadtest/">sample-http-loadtest</a>
      </li>
      
      
      <li class="">
        <a href="/samples/soap-wssecurity/">sample-soap-wssecurity</a>
      </li>
      
      
      <li class="">
        <a href="/samples/soap-ssl/">sample-soap-ssl</a>
      </li>
      
      
    </ul>

    <h4>Miscellaneous</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/behavior/">sample-behavior</a>
      </li>
      
      
      <li class="">
        <a href="/samples/dictionaries/">sample-dictionaries</a>
      </li>
      
      
      <li class="">
        <a href="/samples/gradle/">sample-gradle</a>
      </li>
      
      
      <li class="">
        <a href="/samples/message-store/">sample-message-store</a>
      </li>
      
      
    </ul>

    <h4>Runtimes</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/junit/">sample-junit</a>
      </li>
      
      
      <li class="">
        <a href="/samples/testng/">sample-testng</a>
      </li>
      
      
      <li class="">
        <a href="/samples/dataprovider/">sample-dataprovider</a>
      </li>
      
      
      <li class="">
        <a href="/samples/junit5/">sample-junit5</a>
      </li>
      
      
    </ul>

    <h4>Validation</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/xml/">sample-xml</a>
      </li>
      
      
      <li class="">
        <a href="/samples/hamcrest/">sample-hamcrest</a>
      </li>
      
      
      <li class="">
        <a href="/samples/json/">sample-json</a>
      </li>
      
      
      <li class="">
        <a href="/samples/oxm/">sample-oxm</a>
      </li>
      
      
      <li class="">
        <a href="/samples/xhtml/">sample-xhtml</a>
      </li>
      
      
      <li class="">
        <a href="/samples/databind/">sample-databind</a>
      </li>
      
      
      <li class="">
        <a href="/samples/http-form-data/">sample-http-form-data</a>
      </li>
      
      
      <li class="">
        <a href="/samples/sql/">sample-sql</a>
      </li>
      
      
      <li class="current">
        <a href="/samples/binary/">sample-binary</a>
      </li>
      
    </ul>
  </aside>
</div>


      <div class="clear"></div>

    </div>
  </section>


  <footer role="contentinfo">
  <div class="grid">
    <div class="unit one-third center-on-mobiles">
      <p>Citrus is open source and licensed under <br><a href="https://www.apache.org/licenses/LICENSE-2.0.html">Apache License 2.0</a>.</p>
      <p>This website is licensed under <br><a href="https://github.com/citrusframework/citrus/blob/master/LICENSE">MIT License</a>.</p>
      <br>
      <p>© 2025 ConSol Software GmbH</p>
    </div>
    <div class="unit one-third align-center center-on-mobiles">
      <p>
        <img src="/img/bmi_logo_eng.png" alt="Federal Ministry for Economic Affairs and Energy">
      </p>
    </div>
    <div class="unit one-third align-right center-on-mobiles">
      <p>
        Hosted by<br>
        <a href="http://www.consol.de">
          <img src="/img/sponsor-logo.png" alt="ConSol">
        </a>
      </p>
      <p> </p>
      <br>
      <br>
      <p>
        <a href="http://www.consol.com/legal-notice/">Legal notice</a> | <a href="https://www.consol.com/data-privacy/">Data privacy</a>
      </p>
    </div>
  </div>
</footer>

  <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<span class=\"sr-only\">Permalink</span><i class=\"fa fa-link\"></i>";
    anchor.title = "Permalink";
    return anchor;
  };

  var linkifyAnchors = function (level, containingElement) {
    var headers = containingElement.getElementsByTagName("h" + level);
    for (var h = 0; h < headers.length; h++) {
      var header = headers[h];

      if (typeof header.id !== "undefined" && header.id !== "") {
        header.appendChild(anchorForId(header.id));
      }
    }
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var contentBlock = document.getElementsByClassName("docs")[0] || document.getElementsByClassName("samples")[0] || document.getElementsByClassName("news")[0];
      if (!contentBlock) {
        return;
      }
      for (var level = 1; level <= 6; level++) {
        linkifyAnchors(level, contentBlock);
      }
    }
  };
</script>


</body>
</html>
