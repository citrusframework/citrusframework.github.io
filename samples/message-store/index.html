<!DOCTYPE HTML>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <title>Citrus Framework</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="generator" content="Citrus 4.3.0">
  <meta name="description" content="Citrus Framework Website"/>
  <meta name="author" content="ConSol Software GmbH"/>
  <link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="Citrus Integration Tests" />
  <link rel="alternate" type="application/atom+xml" title="Recent commits to Citrus master branch" href="https://github.com/citrusframework/citrus/commits/master.atom">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic,900">
  <link rel="stylesheet" href="/css/screen.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <!--[if lt IE 9]>
  <script src="/js/html5shiv.min.js"></script>
  <script src="/js/respond.min.js"></script>
  <![endif]-->
</head>


<body class="wrap">
  <header role="banner">
  <nav class="mobile-nav show-on-mobiles">
    <ul>
  <li>
    <img src="/img/brand-logo.png" alt="Citrus"><span class="brand hide-on-mobiles">Citrus</span>
  </li>
  <li class="">
    <a href="/">Home</a>
  </li>
  <li class="">
    <a href="/projects/">Projects</a>
  </li>
  <li class="">
    <a href="/docs/documentation/">Doc<span class="hide-on-mobiles">umentation</span><span class="show-on-mobiles">s</span></a>
  </li>
  <li class="">
    <a href="/samples/">Samples</a>
  </li>
  <li class="">
    <a href="/news/">News<span class="hide-on-mobiles"> &amp; Blog</span></a>
  </li>
  <li class="">
    <a href="/help/">Help</a>
  </li>
  <li>
    <a href="https://github.com/citrusframework/citrus" target="_blank"><span class="hide-on-mobiles">View on </span>GitHub</a>
  </li>
</ul>

  </nav>
  <div class="grid">
    <nav class="main-nav whole hide-on-mobiles">
      <ul>
  <li>
    <img src="/img/brand-logo.png" alt="Citrus"><span class="brand hide-on-mobiles">Citrus</span>
  </li>
  <li class="">
    <a href="/">Home</a>
  </li>
  <li class="">
    <a href="/projects/">Projects</a>
  </li>
  <li class="">
    <a href="/docs/documentation/">Doc<span class="hide-on-mobiles">umentation</span><span class="show-on-mobiles">s</span></a>
  </li>
  <li class="">
    <a href="/samples/">Samples</a>
  </li>
  <li class="">
    <a href="/news/">News<span class="hide-on-mobiles"> &amp; Blog</span></a>
  </li>
  <li class="">
    <a href="/help/">Help</a>
  </li>
  <li>
    <a href="https://github.com/citrusframework/citrus" target="_blank"><span class="hide-on-mobiles">View on </span>GitHub</a>
  </li>
</ul>

    </nav>
  </div>
</header>


    <section class="samples">
    <div class="grid">

      <div class="samples-nav-mobile unit whole show-on-mobiles">
  <select onchange="if (this.value) window.location.href=this.value">
    <option value="">Navigate the samples…</option>
    <option value="/samples/">Overview</option>
    <option value="/samples/todo-app/">Sample app</option>
    <option value="/samples/run/">Running</option>
    
    
    <option value="/samples/binary/">sample-binary</option>
    
    <option value="/samples/kafka/">sample-kafka</option>
    
    <option value="/samples/camel-context/">sample-camel-context</option>
    
    <option value="/samples/dynamic-endpoints/">sample-dynamic-endpoints</option>
    
    <option value="/samples/javaconfig/">sample-javaconfig</option>
    
    <option value="/samples/jms/">sample-jms</option>
    
    <option value="/samples/mail/">sample-mail</option>
    
    <option value="/samples/gradle/">sample-gradle</option>
    
    <option value="/samples/selenium/">sample-selenium</option>
    
    <option value="/samples/arquillian/">sample-javaee</option>
    
    <option value="/samples/kubernetes/">sample-kubernetes</option>
    
    <option value="/samples/hamcrest/">sample-hamcrest</option>
    
    <option value="/samples/docker/">sample-docker</option>
    
    <option value="/samples/reporting/">sample-reporting</option>
    
    <option value="/samples/annotation-config/">sample-annotation-config</option>
    
    <option value="/samples/message-store/">sample-message-store</option>
    
    <option value="/samples/behavior/">sample-behavior</option>
    
    <option value="/samples/dictionaries/">sample-dictionaries</option>
    
    <option value="/samples/rmi/">sample-rmi</option>
    
    <option value="/samples/quarkus/">sample-quarkus</option>
    
    <option value="/samples/cucumber-spring/">sample-cucumber-spring</option>
    
    <option value="/samples/cucumber/">sample-cucumber</option>
    
    <option value="/samples/jdbc/">sample-jdbc</option>
    
    <option value="/samples/sql/">sample-sql</option>
    
    <option value="/samples/ftp/">sample-ftp</option>
    
    <option value="/samples/sftp/">sample-sftp</option>
    
    <option value="/samples/scp/">sample-scp</option>
    
    <option value="/samples/http-form-data/">sample-http-form-data</option>
    
    <option value="/samples/http/">sample-http</option>
    
    <option value="/samples/http-basic-auth/">sample-http-basic-auth</option>
    
    <option value="/samples/http-loadtest/">sample-http-loadtest</option>
    
    <option value="/samples/https/">sample-https</option>
    
    <option value="/samples/swagger/">sample-swagger</option>
    
    <option value="/samples/databind/">sample-databind</option>
    
    <option value="/samples/json/">sample-json</option>
    
    <option value="/samples/junit5/">sample-junit5</option>
    
    <option value="/samples/junit/">sample-junit</option>
    
    <option value="/samples/soap-attachment/">sample-soap-attachment</option>
    
    <option value="/samples/soap/">sample-soap</option>
    
    <option value="/samples/soap-mtom/">sample-soap-mtom</option>
    
    <option value="/samples/wsdl/">sample-wsdl</option>
    
    <option value="/samples/soap-ssl/">sample-soap-ssl</option>
    
    <option value="/samples/soap-wssecurity/">sample-soap-wssecurity</option>
    
    <option value="/samples/http-static-response/">sample-http-static-response</option>
    
    <option value="/samples/soap-wsaddressing/">sample-soap-wsaddressing</option>
    
    <option value="/samples/soap-static-response/">sample-soap-static-response</option>
    
    <option value="/samples/dataprovider/">sample-dataprovider</option>
    
    <option value="/samples/testng/">sample-testng</option>
    
    <option value="/samples/xml/">sample-xml</option>
    
    <option value="/samples/xhtml/">sample-xhtml</option>
    
    <option value="/samples/oxm/">sample-oxm</option>
    
  </select>
</div>


      <div class="unit four-fifths">
        <article>
  <h2>
    Message store sample
    <a href="/samples/message-store/" class="permalink" title="Permalink">∞</a>
  </h2>
  <div class="right">
    
    
    <a href="https://github.com/citrusframework/citrus-samples/blob/master/sample-message-store" target="_blank">
      <i class="fa fa-pencil"></i>&nbsp;View source code
    </a>
    
  </div>
  <span class="post-category">
    <span class="label">
      samples
    </span>
  </span>
  <div class="post-content">
    <p>When Citrus exchanges messages with foreign services the messages are stored internally in a message store. This is an in memory
cache that is filled with messages as they are sent and received within the test case. Read about this feature in <a href="https://citrusframework.org/citrus/reference/html#local-message-store">reference guide</a></p>

<h2 id="objectives">Objectives</h2>

<p>The <a href="/samples/todo-app/">todo-list</a> sample application provides a REST API for managing todo entries.
We call this API and receive Json message structures for validation in our test cases. While exchanging messages with
the todo application Citrus saves all messages to a local message store.</p>

<p>You can access the message store at any time in the test case using message store functions.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">http</span><span class="o">()</span>
    <span class="o">.</span><span class="na">client</span><span class="o">(</span><span class="n">todoClient</span><span class="o">)</span>
    <span class="o">.</span><span class="na">send</span><span class="o">()</span>
    <span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="s">"/api/todolist"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"todoRequest"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">messageType</span><span class="o">(</span><span class="n">MessageType</span><span class="o">.</span><span class="na">JSON</span><span class="o">)</span>
    <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="n">ContentType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">.</span><span class="na">getMimeType</span><span class="o">())</span>
    <span class="o">.</span><span class="na">payload</span><span class="o">(</span><span class="s">"{\"id\": \"citrus:randomUUID()\", \"title\": \"citrus:concat('todo_', citrus:randomNumber(4))\", \"description\": \"ToDo Description\", \"done\": false}"</span><span class="o">);</span>

<span class="n">echo</span><span class="o">(</span><span class="s">"citrus:message(todoRequest)"</span><span class="o">);</span>
</code></pre></div></div>

<p>The send operation above create a new todo entry as Json message payload and sends it to the todo application via Http POST request. The message
receives a name <code class="highlighter-rouge">todoRequest</code>. This is the name that is used to store the message right before it is sent out. As soon as the message processing is complete the
local store is saving the message for later usage in the test.</p>

<p>You can access the message store using the message store function <code class="highlighter-rouge">citrus:message(name)</code>. Using the name of the message provides us the message content as it has been sent to the
todo application.</p>

<p>We are also able to apply some JsonPath expression on the stored message:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">echo</span><span class="o">(</span><span class="s">"citrus:jsonPath(citrus:message(todoRequest.payload()), '$.title')"</span><span class="o">);</span>
</code></pre></div></div>

<p>The echo expression above makes access to the local store reading the message named <code class="highlighter-rouge">todoRequest</code>. The content is then passed to a JsonPath function that is evaluating the todo title with
<code class="highlighter-rouge">$.title</code> path expression. The result is the title of the todo entry that has been sent before.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">http</span><span class="o">()</span>
    <span class="o">.</span><span class="na">client</span><span class="o">(</span><span class="n">todoClient</span><span class="o">)</span>
    <span class="o">.</span><span class="na">receive</span><span class="o">()</span>
    <span class="o">.</span><span class="na">response</span><span class="o">(</span><span class="n">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">)</span>
    <span class="o">.</span><span class="na">messageType</span><span class="o">(</span><span class="n">MessageType</span><span class="o">.</span><span class="na">PLAINTEXT</span><span class="o">)</span>
    <span class="o">.</span><span class="na">payload</span><span class="o">(</span><span class="s">"citrus:jsonPath(citrus:message(todoRequest.payload()), '$.id')"</span><span class="o">);</span>
</code></pre></div></div>

<p>The receive operation has a special message payload which accesses the message store during validation and reads the dynamic todo entry id   that was created in the <code class="highlighter-rouge">todoRequest</code> message.</p>

<p>This gives us the opportunity to access message content of previously handled messages in Citrus. The local message store is per test instance so messages in the store are only visible to the
current test case instance that has created the message in the store.</p>

<p>Also received messages are automatically saved to the local store. So you can access the message in later test actions very easy.</p>

<h2 id="run">Run</h2>

<p>You can execute some sample Citrus test cases in this sample in order to write the reports.
Open a separate command line terminal and navigate to the sample folder.</p>

<p>Execute all Citrus tests by calling</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mvn integration-test
</code></pre></div></div>

<p>You should see Citrus performing several tests with lots of debugging output. 
And of course green tests at the very end of the build and some new reporting files in <code class="highlighter-rouge">target/citrus-reports</code> folder.</p>

<p>Of course you can also start the Citrus tests from your favorite IDE.
Just start the Citrus test using the TestNG IDE integration in IntelliJ, Eclipse or Netbeans.</p>


  </div>
</article>

      </div>

      <div class="unit one-fifth hide-on-mobiles">
  <aside>
    <h4>Common</h4>
    <ul>
      <li class="">
        <a href="/samples/">Overview</a>
      </li>
      <li class="">
        <a href="/samples/todo-app">Sample application</a>
      </li>
      <li class="">
        <a href="/samples/run">Running</a>
      </li>
    </ul>
    <h4>Samples</h4>
    <ul style="margin-top: 5px;">
      
      

      
      
      <li class="">
        <a href="/samples/binary/">sample-binary</a>
      </li>
      
      
      <li class="">
        <a href="/samples/kafka/">sample-kafka</a>
      </li>
      
      
      <li class="">
        <a href="/samples/camel-context/">sample-camel-context</a>
      </li>
      
      
      <li class="">
        <a href="/samples/dynamic-endpoints/">sample-dynamic-endpoints</a>
      </li>
      
      
      <li class="">
        <a href="/samples/javaconfig/">sample-javaconfig</a>
      </li>
      
      
      <li class="">
        <a href="/samples/jms/">sample-jms</a>
      </li>
      
      
      <li class="">
        <a href="/samples/mail/">sample-mail</a>
      </li>
      
      
      <li class="">
        <a href="/samples/gradle/">sample-gradle</a>
      </li>
      
      
      <li class="">
        <a href="/samples/selenium/">sample-selenium</a>
      </li>
      
      
      <li class="">
        <a href="/samples/arquillian/">sample-javaee</a>
      </li>
      
      
      <li class="">
        <a href="/samples/kubernetes/">sample-kubernetes</a>
      </li>
      
      
      <li class="">
        <a href="/samples/hamcrest/">sample-hamcrest</a>
      </li>
      
      
      <li class="">
        <a href="/samples/docker/">sample-docker</a>
      </li>
      
      
      <li class="">
        <a href="/samples/reporting/">sample-reporting</a>
      </li>
      
      
      <li class="">
        <a href="/samples/annotation-config/">sample-annotation-config</a>
      </li>
      
      
      <li class="current">
        <a href="/samples/message-store/">sample-message-store</a>
      </li>
      
      
      <li class="">
        <a href="/samples/behavior/">sample-behavior</a>
      </li>
      
      
      <li class="">
        <a href="/samples/dictionaries/">sample-dictionaries</a>
      </li>
      
      
      <li class="">
        <a href="/samples/rmi/">sample-rmi</a>
      </li>
      
      
    </ul>

    
    <h4>Demo&nbsp;&nbsp;</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/quarkus/">sample-quarkus</a>
      </li>
      
      
    </ul>

    
    <h4>Samples&nbsp;&nbsp;Cucumber</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/cucumber-spring/">sample-cucumber-spring</a>
      </li>
      
      
      <li class="">
        <a href="/samples/cucumber/">sample-cucumber</a>
      </li>
      
      
    </ul>

    
    <h4>Samples&nbsp;&nbsp;Db</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/jdbc/">sample-jdbc</a>
      </li>
      
      
      <li class="">
        <a href="/samples/sql/">sample-sql</a>
      </li>
      
      
    </ul>

    
    <h4>Samples&nbsp;&nbsp;Ftp</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/ftp/">sample-ftp</a>
      </li>
      
      
      <li class="">
        <a href="/samples/sftp/">sample-sftp</a>
      </li>
      
      
      <li class="">
        <a href="/samples/scp/">sample-scp</a>
      </li>
      
      
    </ul>

    
    <h4>Samples&nbsp;&nbsp;Http</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/http-form-data/">sample-http-form-data</a>
      </li>
      
      
      <li class="">
        <a href="/samples/http/">sample-http</a>
      </li>
      
      
      <li class="">
        <a href="/samples/http-basic-auth/">sample-http-basic-auth</a>
      </li>
      
      
      <li class="">
        <a href="/samples/http-loadtest/">sample-http-loadtest</a>
      </li>
      
      
      <li class="">
        <a href="/samples/https/">sample-https</a>
      </li>
      
      
      <li class="">
        <a href="/samples/swagger/">sample-swagger</a>
      </li>
      
      
    </ul>

    
    <h4>Samples&nbsp;&nbsp;Json</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/databind/">sample-databind</a>
      </li>
      
      
      <li class="">
        <a href="/samples/json/">sample-json</a>
      </li>
      
      
    </ul>

    
    <h4>Samples&nbsp;&nbsp;Junit</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/junit5/">sample-junit5</a>
      </li>
      
      
      <li class="">
        <a href="/samples/junit/">sample-junit</a>
      </li>
      
      
    </ul>

    
    <h4>Samples&nbsp;&nbsp;Soap</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/soap-attachment/">sample-soap-attachment</a>
      </li>
      
      
      <li class="">
        <a href="/samples/soap/">sample-soap</a>
      </li>
      
      
      <li class="">
        <a href="/samples/soap-mtom/">sample-soap-mtom</a>
      </li>
      
      
      <li class="">
        <a href="/samples/wsdl/">sample-wsdl</a>
      </li>
      
      
      <li class="">
        <a href="/samples/soap-ssl/">sample-soap-ssl</a>
      </li>
      
      
      <li class="">
        <a href="/samples/soap-wssecurity/">sample-soap-wssecurity</a>
      </li>
      
      
      <li class="">
        <a href="/samples/http-static-response/">sample-http-static-response</a>
      </li>
      
      
      <li class="">
        <a href="/samples/soap-wsaddressing/">sample-soap-wsaddressing</a>
      </li>
      
      
      <li class="">
        <a href="/samples/soap-static-response/">sample-soap-static-response</a>
      </li>
      
      
    </ul>

    
    <h4>Samples&nbsp;&nbsp;Testng</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/dataprovider/">sample-dataprovider</a>
      </li>
      
      
      <li class="">
        <a href="/samples/testng/">sample-testng</a>
      </li>
      
      
    </ul>

    
    <h4>Samples&nbsp;&nbsp;Xml</h4>
    <ul style="margin-top: 5px;">
      
      
      <li class="">
        <a href="/samples/xml/">sample-xml</a>
      </li>
      
      
      <li class="">
        <a href="/samples/xhtml/">sample-xhtml</a>
      </li>
      
      
      <li class="">
        <a href="/samples/oxm/">sample-oxm</a>
      </li>
      
    </ul>
  </aside>
</div>


      <div class="clear"></div>

    </div>
  </section>


  <footer role="contentinfo">
  <div class="grid">
    <div class="unit one-third center-on-mobiles">
      <p>Citrus is open source and licensed under <br><a href="https://www.apache.org/licenses/LICENSE-2.0.html">Apache&nbsp;License&nbsp;2.0</a>.</p>
      <p>This website is licensed under <br><a href="https://github.com/citrusframework/citrus/blob/master/LICENSE">MIT&nbsp;License</a>.</p>
      <br/>
      <p>&copy;&nbsp;2024 ConSol Software GmbH</p>
    </div>
    <div class="unit one-third align-center center-on-mobiles">
      <p>
        <img src="/img/bmi_logo_eng.png" alt="Federal Ministry for Economic Affairs and Energy">
      </p>
    </div>
    <div class="unit one-third align-right center-on-mobiles">
      <p>
        Hosted by<br>
        <a href="http://www.consol.de">
          <img src="/img/sponsor-logo.png" alt="ConSol">
        </a>
      </p>
      <p>&nbsp;</p>
      <br/>
      <br/>
      <p>
        <a href="http://www.consol.com/legal-notice/">Legal notice</a> | <a href="https://www.consol.com/data-privacy/">Data privacy</a>
      </p>
    </div>
  </div>
</footer>

  <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<span class=\"sr-only\">Permalink</span><i class=\"fa fa-link\"></i>";
    anchor.title = "Permalink";
    return anchor;
  };

  var linkifyAnchors = function (level, containingElement) {
    var headers = containingElement.getElementsByTagName("h" + level);
    for (var h = 0; h < headers.length; h++) {
      var header = headers[h];

      if (typeof header.id !== "undefined" && header.id !== "") {
        header.appendChild(anchorForId(header.id));
      }
    }
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var contentBlock = document.getElementsByClassName("docs")[0] || document.getElementsByClassName("samples")[0] || document.getElementsByClassName("news")[0];
      if (!contentBlock) {
        return;
      }
      for (var level = 1; level <= 6; level++) {
        linkifyAnchors(level, contentBlock);
      }
    }
  };
</script>


</body>
</html>
