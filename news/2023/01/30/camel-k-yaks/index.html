<!DOCTYPE HTML>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <title>Citrus Framework</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="generator" content="Citrus 4.2.0">
  <meta name="description" content="Citrus Framework Website"/>
  <meta name="author" content="ConSol Software GmbH"/>
  <link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="Citrus Integration Tests" />
  <link rel="alternate" type="application/atom+xml" title="Recent commits to Citrus master branch" href="https://github.com/citrusframework/citrus/commits/master.atom">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic,900">
  <link rel="stylesheet" href="/css/screen.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <!--[if lt IE 9]>
  <script src="/js/html5shiv.min.js"></script>
  <script src="/js/respond.min.js"></script>
  <![endif]-->
</head>


<body class="wrap">
  <header role="banner">
  <nav class="mobile-nav show-on-mobiles">
    <ul>
  <li>
    <img src="/img/brand-logo.png" alt="Citrus"><span class="brand hide-on-mobiles">Citrus</span>
  </li>
  <li class="">
    <a href="/">Home</a>
  </li>
  <li class="">
    <a href="/projects/">Projects</a>
  </li>
  <li class="">
    <a href="/docs/documentation/">Doc<span class="hide-on-mobiles">umentation</span><span class="show-on-mobiles">s</span></a>
  </li>
  <li class="">
    <a href="/samples/">Samples</a>
  </li>
  <li class="current">
    <a href="/news/">News<span class="hide-on-mobiles"> &amp; Blog</span></a>
  </li>
  <li class="">
    <a href="/help/">Help</a>
  </li>
  <li>
    <a href="https://github.com/citrusframework/citrus" target="_blank"><span class="hide-on-mobiles">View on </span>GitHub</a>
  </li>
</ul>

  </nav>
  <div class="grid">
    <nav class="main-nav whole hide-on-mobiles">
      <ul>
  <li>
    <img src="/img/brand-logo.png" alt="Citrus"><span class="brand hide-on-mobiles">Citrus</span>
  </li>
  <li class="">
    <a href="/">Home</a>
  </li>
  <li class="">
    <a href="/projects/">Projects</a>
  </li>
  <li class="">
    <a href="/docs/documentation/">Doc<span class="hide-on-mobiles">umentation</span><span class="show-on-mobiles">s</span></a>
  </li>
  <li class="">
    <a href="/samples/">Samples</a>
  </li>
  <li class="current">
    <a href="/news/">News<span class="hide-on-mobiles"> &amp; Blog</span></a>
  </li>
  <li class="">
    <a href="/help/">Help</a>
  </li>
  <li>
    <a href="https://github.com/citrusframework/citrus" target="_blank"><span class="hide-on-mobiles">View on </span>GitHub</a>
  </li>
</ul>

    </nav>
  </div>
</header>


    <section class="news">
    <div class="grid">

      <div class="docs-nav-mobile unit whole show-on-mobiles">
  <select onchange="if (this.value) window.location.href=this.value">
    <option value="">Navigate the blog…</option>
    <option value="/news/">News</option>
    <option value="/docs/history/">Releases</option>
    <optgroup label="Posts">
      
      <option value="/news/2023/10/25/release-4.0.0/">Citrus 4.0.0</option>
      
      <option value="/news/2023/01/30/camel-k-yaks/">Testing Camel K with YAKS</option>
      
      <option value="/news/2021/08/30/introducing-yaks/">Cloud-native BDD testing with YAKS</option>
      
      <option value="/news/2021/08/25/new-camel-support/">Apache Camel support in Citrus 3</option>
      
      <option value="/news/2021/08/16/citrus-3.0/">YAY, Citrus 3.0 is here!</option>
      
      <option value="/news/2018/09/19/upcoming-changes/">Upcoming changes - What the future holds for Citrus</option>
      
      <option value="/news/2017/09/21/introducing-citrus-simulator/">Simulating 3rd party services with Spring Boot and Citrus</option>
      
      <option value="/news/2017/07/07/introducing-citrus-admin/">Introducing Citrus Admin Web UI</option>
      
      <option value="/news/2016/03/15/jcache-chat-citrus/">Testing WebSockets with a Citrus twist</option>
      
      <option value="/news/2015/08/19/arquillian-extension-part-2/">Arquillian & Citrus in combination - Part 2</option>
      
      <option value="/news/2015/06/29/arquillian-extension-part-1/">Arquillian & Citrus in combination - Part 1</option>
      
      <option value="/news/2015/06/03/camel-testing-part-3/">Apache Camel Integration Testing - Part 3</option>
      
      <option value="/news/2015/05/27/camel-testing-part-2/">Apache Camel Integration Testing - Part 2</option>
      
      <option value="/news/2014/11/21/camel-testing-part-1/">Apache Camel Integration Testing - Part 1</option>
      
      <option value="/news/2014/05/30/testing-webmethods-with-citrus-part-ii/">Testing webMethods with Citrus Part II</option>
      
      <option value="/news/2014/03/06/testing-webmethods-with-citrus-part-i/">Testing webMethods with Citrus Part I</option>
      
      <option value="/news/2011/06/22/excel-validation/">Validate Excel files in Citrus</option>
      
      <option value="/news/2011/06/17/testng-data-provider/">Use TestNG data providers in Citrus</option>
      
      <option value="/news/2010/12/14/integrate-your-own-validator/">Integrate your own validator into your Citrus project</option>
      
      <option value="/news/2010/08/13/testng-groups/">Citrus and TestNG groups</option>
      
      <option value="/news/2010/05/19/soap-mustunderstand/">Handle SOAP-ENV:mustUnderstand headers</option>
      
      <option value="/news/2010/01/18/custom-meta-info/">Customize meta information</option>
      
    </optgroup>
  </select>
</div>


      <div class="unit four-fifths">
        <article>
  <h2>
    Testing Camel K with YAKS
    <a href="/news/2023/01/30/camel-k-yaks/" class="permalink" title="Permalink">∞</a>
  </h2>
  <span class="post-category">
    <span class="label">
      blog
    </span>
  </span>
  <div class="post-meta">
    <span class="post-date">
      30 Jan 2023
    </span>
    <a href="https://github.com/christophd" class="post-author">
      Christoph Deppisch
    </a>
  </div>
  <div class="post-content">
    <p>This post describes the steps to test a Camel K integration with YAKS both locally and on the Kubernetes platform.</p>

<p><img src="/img/assets/camel-k-yaks/featured.png" alt="featured.png" /></p>

<h1 id="what-is-yaks">What is YAKS?</h1>

<p><a href="https://github.com/citrusframework/yaks">YAKS</a> is an Open Source test automation platform that leverages Behavior Driven
Development concepts for running tests locally and on Cloud infrastructure (e.g. <a href="https://kubernetes.io/">Kubernetes</a> or
<a href="https://www.openshift.com/">OpenShift</a>).
This means that the testing tool is able to run your tests both as local tests and natively on Kubernetes.
The framework is specifically designed to verify Serverless and Microservice applications and aims for integration testing
with the application under test up and running in a production-like environment.
A typical YAKS test uses the very same infrastructure as the application under test and exchanges data/events over different
messaging transports (e.g. Http REST, Knative eventing, Kafka, JMS and many more).</p>

<p>As YAKS itself is written in Java the runtime uses a Java virtual machine with build tools such as Maven and integrates with
well known Java testing frameworks such as <a href="https://junit.org/junit5/">JUnit</a>, <a href="https://cucumber.io/">Cucumber</a> and
<a href="https://citrusframework.org">Citrus</a> to run the tests.</p>

<h1 id="understanding-the-camel-k-example">Understanding the Camel K example</h1>

<p>First of all here is a small sample Camel K integration that we would like to test in the following.
The integration exposes a Http service to the user.
The service accepts client Http POST requests that add fruit model objects.
The Camel K route applies content based routing to store the fruits in different AWS S3 buckets.</p>

<p><img src="/img/assets/camel-k-yaks/test-scenario.png" alt="test-scenario.png" /></p>

<p>In the test scenario YAKS is going to invoke the Camel K service and verify that the message content has been sent to the right AWS S3 bucket.</p>

<p>Here is a sample fruit model object that is subject to be stored in AWS S3:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pineapple"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"category"</span><span class="p">:{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"tropical"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"nutrition"</span><span class="p">:{</span><span class="w">
    </span><span class="s2">"calories"</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sugar"</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AVAILABLE"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.59</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"sweet"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Here is the Camel K integration route:</p>

<div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">from</span><span class="o">(</span><span class="s1">'platform-http:/fruits'</span><span class="o">)</span>
    <span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="s1">'received fruit ${body}'</span><span class="o">)</span>
    <span class="o">.</span><span class="na">unmarshal</span><span class="o">().</span><span class="na">json</span><span class="o">()</span>
    <span class="o">.</span><span class="na">removeHeaders</span><span class="o">(</span><span class="s2">"*"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s2">"CamelAwsS3Key"</span><span class="o">,</span> <span class="n">constant</span><span class="o">(</span><span class="s2">"fruit.json"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">choice</span><span class="o">()</span>
        <span class="o">.</span><span class="na">when</span><span class="o">().</span><span class="na">simple</span><span class="o">(</span><span class="s1">'${body[nutrition][sugar]} &lt;= 5'</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s2">"CamelAwsS3BucketName"</span><span class="o">,</span> <span class="n">constant</span><span class="o">(</span><span class="s2">"low-sugar"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">when</span><span class="o">().</span><span class="na">simple</span><span class="o">(</span><span class="s1">'${body[nutrition][sugar]} &gt; 5 &amp;&amp; ${body[nutrition][sugar]} &lt;= 10'</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s2">"CamelAwsS3BucketName"</span><span class="o">,</span> <span class="n">constant</span><span class="o">(</span><span class="s2">"medium-sugar"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">otherwise</span><span class="o">()</span>
            <span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s2">"CamelAwsS3BucketName"</span><span class="o">,</span> <span class="n">constant</span><span class="o">(</span><span class="s2">"high-sugar"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">end</span><span class="o">()</span>
    <span class="o">.</span><span class="na">marshal</span><span class="o">().</span><span class="na">json</span><span class="o">()</span>
    <span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="s1">'sending ${body}'</span><span class="o">)</span>
    <span class="o">.</span><span class="na">to</span><span class="o">(</span><span class="s2">"aws2-s3://noop?$parameters"</span><span class="o">)</span>
</code></pre></div></div>

<p>The route uses content based routing EAP based on the nutrition sugar rating of a given fruit in order to send the fruits
to different AWS S3 buckets (low-sugar, medium-sugar, high-sugar).</p>

<p>In the following the test case for this integration needs to invoke the exposed service with different fruits and verify its outcome on AWS S3.</p>

<h1 id="how-to-test-locally-with-yaks">How to test locally with YAKS</h1>

<p>In the beginning let’s just write the test and run it locally.
For now, we do not care how to deploy the application under test in the Cloud infrastructure as everything is running on
the local machine using <a href="https://www.jbang.dev/">JBang</a>.</p>

<p>JBang is a fantastic way to just start coding and running Java code and also Camel K integrations.</p>

<p>YAKS as a framework brings a set of ready-to-use domain specific languages (XML, YAML, Groovy, BDD Cucumber steps) for writing
tests in order to verify your deployed services.</p>

<p>This post uses the Behavior Driven Development integration via Cucumber.
So the YAKS test is a single feature file that uses BDD Gherkin syntax like this:</p>

<div class="language-gherkin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">Feature</span><span class="p">:</span> Camel K Fruit Store

  <span class="kn">Background</span><span class="p">:</span>
    <span class="err">Given URL</span><span class="p">:</span> <span class="err">http</span><span class="p">:</span><span class="err">//localhost</span><span class="p">:</span><span class="err">8080</span>

  <span class="kn">Scenario</span><span class="p">:</span> Create infrastructure
    <span class="c"># Start AWS S3 container</span>
    <span class="nf">Given </span>Enable service S3
    <span class="nf">Given </span>start LocalStack container

    <span class="c"># Create Camel K integration</span>
    <span class="nf">Given </span>Camel K integration property file aws-s3-credentials.properties
    <span class="nf">When </span>load Camel K integration fruit-service.groovy
    <span class="err">Then Camel K integration fruit-service should print Started route1 (platform-http</span><span class="p">:</span><span class="err">///fruits)</span>

  <span class="kn">Scenario</span><span class="p">:</span> Verify fruit service
    <span class="c"># Invoke Camel K service</span>
    <span class="err">Given HTTP request body</span><span class="p">:</span> <span class="err">yaks</span><span class="p">:</span><span class="err">readFile('pineapple.json')</span>
    <span class="nf">And </span>HTTP request header Content-Type="application/json"
    <span class="nf">When </span>send POST /fruits
    <span class="nf">Then </span>receive HTTP 200 OK

    <span class="c"># Verify uploaded S3 file</span>
    <span class="nf">Given </span>New global Camel context
    <span class="nf">Given </span>load to Camel registry amazonS3Client.groovy
    <span class="nf">Given </span>Camel exchange message header CamelAwsS3Key="fruit.json"
    <span class="err">Given receive Camel exchange from("aws2-s3</span><span class="p">:</span><span class="err">//medium-sugar?amazonS3Client=#amazonS3Client&amp;deleteAfterRead=true") with body</span><span class="p">:</span> <span class="err">yaks</span><span class="p">:</span><span class="err">readFile('pineapple.json')</span>
</code></pre></div></div>

<p>Let’s walk through the test step by step.
First of all the feature file uses the usual Given-When-Then BDD syntax to give context, describe the actions and verify the outcome.
Each step calls a specific YAKS action that is provided out of the box by the framework.
The user is able to choose from a <a href="https://github.com/citrusframework/yaks/tree/main/java/steps">huge set of steps</a> that
automatically perform actions like sending/receiving Http requests/responses, starting <a href="https://www.testcontainers.org/">Testcontainers</a>,
running Camel routes, connecting to a database, publishing events on Kafka or Knative brokers and many more.</p>

<p>In the first scenario the test automatically prepares some required infrastructure.
The YAKS test starts a Localstack <a href="https://www.testcontainers.org/">Testcontainer</a> to have an AWS S3 test instance running (<code class="highlighter-rouge">Given start LocalStack container</code>).
Then the test loads and starts the Camel K integration under test (<code class="highlighter-rouge">When load Camel K integration fruit-service.groovy</code>) and waits for it to properly start.
In local testing this step starts the Camel K integration using JBang.
Later the post will also run the test in a Kubernetes environment.</p>

<p>Now the infrastructure is up and running and the test is able to load the fruit model object as Http request body
(<code class="highlighter-rouge">Given HTTP request body: yaks:readFile('pineapple.json')</code>) and invoke the Camel K service (<code class="highlighter-rouge">When send POST /fruits</code>).
The test waits for the Http response and verifies its 200 OK status.</p>

<p>In the last step the test verifies that the fruit object has been added to the right AWS S3 bucket (medium-sugar).
As YAKS itself is not able to connect to AWS S3 the test uses Apache Camel for this step.
The test creates a Camel context, loads a AWS client and connects to AWS S3 with a temporary Camel route
(<code class="highlighter-rouge">Given receive Camel exchange from("aws2-s3://medium-sugar?amazonS3Client=#amazonS3Client&amp;deleteAfterRead=true")</code>).
With this Apache Camel integration YAKS is able to use the complete 300+ Camel components for sending and receiving messages
to various messaging transports. The Camel exchange body should be the same fruit model object (<code class="highlighter-rouge">yaks:readFile('pineapple.json'</code>)
as posted in the initial Http request.</p>

<p>YAKS uses the powerful message payload validation capabilities provided by Citrus for this message content verification.
The validation is able to compare message contents of type XML, Json, plaintext and many more.</p>

<p>This completes the test case. You can now run this test with Cucumber and JUnit for instance.
The easiest way though to directly run tests with YAKS is to use the <a href="https://github.com/citrusframework/yaks/releases">YAKS command line client</a>.
You do not need to set up a whole project with Maven dependencies and so on.
Just write the test file and run with:</p>

<p>```shell script
$ yaks run fruit-service.feature –local</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
You should see some log output like this:

</code></pre></div></div>
<p>INFO |
INFO | ————————————————————————
INFO |        .__  __
INFO |   <strong>__ |</strong>|/  |<strong>__</strong>__ __ __  <strong>__</strong>
INFO | _/ <strong><em>|  \   ___  __ \  |  \/  __</em>/
INFO | \  _</strong>|  ||  |  |  | \/  |  /___ \
INFO |  ___  &gt;<strong>||</strong>|  |<strong>|  |</strong><strong>//</strong>__  &gt;
INFO |      \/                           \/
INFO |
INFO | C I T R U S  T E S T S  3.4.0
INFO |
INFO | ————————————————————————
INFO |</p>

<p>Scenario: Create infrastructure # fruit-service.feature:6
  Given URL: http://localhost:8080
  Given Enable service S3
  […]</p>

<p>Scenario: Verify fruit service # fruit-service.feature:20
  Given URL: http://localhost:8080
  Given HTTP request body: yaks:readFile(‘pineapple.json’)
  […]</p>

<p>Scenario: Remove infrastructure  # fruit-service.feature:31
  Given URL: http://localhost:8080
  Given delete Camel K integration fruit-service
  Given stop LocalStack container</p>

<p>3 Scenarios (3 passed)
18 Steps (18 passed)
0m18,051s</p>

<table>
  <tbody>
    <tr>
      <td>INFO</td>
      <td>————————————————————————</td>
    </tr>
    <tr>
      <td>INFO</td>
      <td> </td>
    </tr>
    <tr>
      <td>INFO</td>
      <td>CITRUS TEST RESULTS</td>
    </tr>
    <tr>
      <td>INFO</td>
      <td> </td>
    </tr>
    <tr>
      <td>INFO</td>
      <td>Create infrastructure …………………………………… SUCCESS</td>
    </tr>
    <tr>
      <td>INFO</td>
      <td>Verify fruit service ……………………………………. SUCCESS</td>
    </tr>
    <tr>
      <td>INFO</td>
      <td>Remove infrastructure …………………………………… SUCCESS</td>
    </tr>
    <tr>
      <td>INFO</td>
      <td> </td>
    </tr>
    <tr>
      <td>INFO</td>
      <td>TOTAL:	3</td>
    </tr>
    <tr>
      <td>INFO</td>
      <td>FAILED:	0 (0.0%)</td>
    </tr>
    <tr>
      <td>INFO</td>
      <td>SUCCESS:	3 (100.0%)</td>
    </tr>
    <tr>
      <td>INFO</td>
      <td> </td>
    </tr>
    <tr>
      <td>INFO</td>
      <td>————————————————————————</td>
    </tr>
  </tbody>
</table>

<p>3 Scenarios (3 passed)
18 Steps (18 passed)
0m18,051s</p>

<p>Test results: Total: 0, Passed: 1, Failed: 0, Errors: 0, Skipped: 0
    fruit-service (fruit-service.feature): Passed</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
# Running YAKS in the Cloud

YAKS is able to run tests both locally and as part of a Kubernetes cluster.
When running tests on Cloud infrastructure YAKS leverages the Operator SDK and provides a specific operator to manage the
test case resources on the cluster.
Each time you declare a test in the form of a [custom resource](https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/)
the YAKS operator automatically takes care of preparing the proper runtime in order to execute the test as a Kubernetes Pod.

Why would you want to run tests as Cloud-native resources on the Kubernetes platform? Kubernetes has become a standard target
platform for Serverless and Microservices architectures.
Developing the services is different in many aspects compared to what we have done for decades.

Writing a Serverless or Microservices application for instance with Camel K is very declarative.
As a developer you just write the Camel route and run it as an integration via the Camel K operator directly on the cluster.
The declarative approach as well as the nature of Serverless applications make us rely on a given runtime infrastructure,
and it is essential to verify the applications also on that infrastructure. So it is only natural to also move the verifying
tests into this very same Cloud infrastructure.
This is why YAKS also brings your tests to the Cloud infrastructure for integration and end-to-end testing.

So here is how it works. You are able to run the very same YAKS test that has been run locally also as a Pod in Kubernetes.

YAKS provides a Kubernetes operator and a set of CRDs (custom resources) that we need to install on the cluster.
The best way to install YAKS is to use the [OperatorHub](https://operatorhub.io/operator/yaks) or the yaks CLI tools that
you can download from the [YAKS GitHub release pages](https://github.com/citrusframework/yaks/releases).

With the yaks-client binary simply run this install command:

```shell script
$ yaks install
</code></pre></div></div>

<p>This command prepares your Kubernetes cluster for running tests with YAKS.
It will take care of installing the YAKS custom resource definitions, setting up role permissions and creating the YAKS operator
in a global operator namespace.</p>

<p><strong>Important:</strong> You need to be a cluster admin to install custom resource definitions.
The operation needs to be done only once for the entire cluster.</p>

<p>Now that the YAKS operator is up and running you can run the very same test from local testing also on the Cloud infrastructure.
The only thing that needs to be done is to adjust the Http endpoint URL of the Camel K integration from <code class="highlighter-rouge">http://localhost:8080</code> to <code class="highlighter-rouge">http://fruit-service.${YAKS_NAMESPACE</code>}</p>

<p>```shell script
$ yaks run fruit-service.feature</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Please notice that we have just skipped the `--local` CLI option.
Instead of using local JBang tooling to run the test locally now the YAKS CLI connects to the Kubernetes cluster in order
to create the test as a custom resource.
From there the YAKS operator takes over preparing the test runtime and running the test as a Pod.

But wait! The test did prepare some infrastructure, in particular the Camel K integration and the AWS S3 Localstack Testcontainer instance.
How does that work inside Kubernetes? YAKS completely takes care of it.
The Camel K integration is run with the Camel K operator running on the same Kubernetes cluster.
And the Testcontainer AWS S3 instance is automatically run as a Pod in Kubernetes.
Even connection settings are handled automatically. It just works!

You will see some similar test log output when running the test remotely and the test performs its actions and its validation
exactly the same as locally.

You can also review the test Pod outcome with:

```shell script
$ yaks ls
</code></pre></div></div>

<p>This is an example output you should get:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME           PHASE   TOTAL  PASSED  FAILED  SKIPPED  ERRORS
fruit-service  Passed  3      3       0       0        0
</code></pre></div></div>

<h1 id="demo">Demo</h1>

<p>The whole demo code is available on this <a href="https://github.com/christophd/yaks-demo-camel-k">GitHub repository</a>.
It also shows how to integrate the tests in a <a href="https://github.com/christophd/yaks-demo-camel-k/actions">GitHub CI actions workflow</a>,
so you can run the tests automatically with every code change.</p>

<h1 id="conclusion">Conclusion</h1>

<p>This blog post showed how you can test Camel K integrations locally and in a Cloud infrastructure with YAKS.
YAKS as a framework has many more features to offer (Kafka, Knative, OpenAPI, etc.) so this is just the start of a new testing
platform for BDD testing in Cloud-native environments!</p>

<p>Please give feedback, ideas and of course contributions to this.
Feel free to add your thoughts on the YAKS repository by opening <a href="https://github.com/citrusframework/yaks/issues">new issues</a> or
even share your appreciation with a <a href="https://github.com/citrusframework/yaks">star on GitHub</a>.</p>


  </div>
</article>

      </div>

      <div class="unit one-fifth hide-on-mobiles">
  <aside>
    <h4>Overview</h4>
    <ul>
      <li class="">
        <a href="/news/">All Posts</a>
      </li>
      <li class="">
        <a href="/docs/history/">All Releases</a>
      </li>
    </ul>
    <h4>Posts</h4>
    <ul>
        
        <li class="">
          <a href="/news/2023/10/25/release-4.0.0/">» Citrus 4.0.0</a>
        </li>
        
        <li class="current">
          <a href="/news/2023/01/30/camel-k-yaks/">» Camel K & YAKS</a>
        </li>
        
        <li class="">
          <a href="/news/2021/08/30/introducing-yaks/">» YAKS BDD testing</a>
        </li>
        
        <li class="">
          <a href="/news/2021/08/25/new-camel-support/">» Citrus and Apache Camel</a>
        </li>
        
        <li class="">
          <a href="/news/2021/08/16/citrus-3.0/">» Citrus 3.0</a>
        </li>
        
        <li class="">
          <a href="/news/2018/09/19/upcoming-changes/">» Future of Citrus</a>
        </li>
        
        <li class="">
          <a href="/news/2017/09/21/introducing-citrus-simulator/">» Citrus Simulator</a>
        </li>
        
        <li class="">
          <a href="/news/2017/07/07/introducing-citrus-admin/">» Admin UI</a>
        </li>
        
        <li class="">
          <a href="/news/2016/03/15/jcache-chat-citrus/">» Testing WebSockets</a>
        </li>
        
        <li class="">
          <a href="/news/2015/08/19/arquillian-extension-part-2/">» Arquillian & Citrus II</a>
        </li>
        
        <li class="">
          <a href="/news/2015/06/29/arquillian-extension-part-1/">» Arquillian & Citrus I</a>
        </li>
        
        <li class="">
          <a href="/news/2015/06/03/camel-testing-part-3/">» Apache Camel III</a>
        </li>
        
        <li class="">
          <a href="/news/2015/05/27/camel-testing-part-2/">» Apache Camel II</a>
        </li>
        
        <li class="">
          <a href="/news/2014/11/21/camel-testing-part-1/">» Apache Camel I</a>
        </li>
        
        <li class="">
          <a href="/news/2014/05/30/testing-webmethods-with-citrus-part-ii/">» Testing webMethods II</a>
        </li>
        
        <li class="">
          <a href="/news/2014/03/06/testing-webmethods-with-citrus-part-i/">» Testing webMethods I</a>
        </li>
        
        <li class="">
          <a href="/news/2011/06/22/excel-validation/">» Validate Excel files</a>
        </li>
        
        <li class="">
          <a href="/news/2011/06/17/testng-data-provider/">» TestNG data providers</a>
        </li>
        
        <li class="">
          <a href="/news/2010/12/14/integrate-your-own-validator/">» Integrate your own validator</a>
        </li>
        
        <li class="">
          <a href="/news/2010/08/13/testng-groups/">» TestNG groups</a>
        </li>
        
        <li class="">
          <a href="/news/2010/05/19/soap-mustunderstand/">» SOAP-ENV:mustUnderstand</a>
        </li>
        
        <li class="">
          <a href="/news/2010/01/18/custom-meta-info/">» Custom meta info</a>
        </li>
        
    </ul>
  </aside>
</div>


      <div class="clear"></div>

    </div>
  </section>


  <footer role="contentinfo">
  <div class="grid">
    <div class="unit one-third center-on-mobiles">
      <p>Citrus is open source and licensed under <br><a href="https://www.apache.org/licenses/LICENSE-2.0.html">Apache&nbsp;License&nbsp;2.0</a>.</p>
      <p>This website is licensed under <br><a href="https://github.com/citrusframework/citrus/blob/master/LICENSE">MIT&nbsp;License</a>.</p>
      <br/>
      <p>&copy;&nbsp;2024 ConSol Software GmbH</p>
    </div>
    <div class="unit one-third align-center center-on-mobiles">
      <p>
        <img src="/img/bmi_logo_eng.png" alt="Federal Ministry for Economic Affairs and Energy">
      </p>
    </div>
    <div class="unit one-third align-right center-on-mobiles">
      <p>
        Hosted by<br>
        <a href="http://www.consol.de">
          <img src="/img/sponsor-logo.png" alt="ConSol">
        </a>
      </p>
      <p>&nbsp;</p>
      <br/>
      <br/>
      <p>
        <a href="http://www.consol.com/legal-notice/">Legal notice</a> | <a href="https://www.consol.com/data-privacy/">Data privacy</a>
      </p>
    </div>
  </div>
</footer>

  <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<span class=\"sr-only\">Permalink</span><i class=\"fa fa-link\"></i>";
    anchor.title = "Permalink";
    return anchor;
  };

  var linkifyAnchors = function (level, containingElement) {
    var headers = containingElement.getElementsByTagName("h" + level);
    for (var h = 0; h < headers.length; h++) {
      var header = headers[h];

      if (typeof header.id !== "undefined" && header.id !== "") {
        header.appendChild(anchorForId(header.id));
      }
    }
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var contentBlock = document.getElementsByClassName("docs")[0] || document.getElementsByClassName("samples")[0] || document.getElementsByClassName("news")[0];
      if (!contentBlock) {
        return;
      }
      for (var level = 1; level <= 6; level++) {
        linkifyAnchors(level, contentBlock);
      }
    }
  };
</script>


</body>
</html>
