<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;11.&nbsp;Connecting with JMS</title><link rel="stylesheet" href="reference-html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="Citrus Framework - Reference Documentation"><link rel="up" href="index.html" title="Citrus Framework - Reference Documentation"><link rel="prev" href="xpath.html" title="Chapter&nbsp;10.&nbsp;Using XPath"><link rel="next" href="http.html" title="Chapter&nbsp;12.&nbsp;Http Support"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;11.&nbsp;Connecting with JMS</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="xpath.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="http.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter&nbsp;11.&nbsp;Connecting with JMS"><div class="titlepage"><div><div><h2 class="title"><a name="jms"></a>Chapter&nbsp;11.&nbsp;Connecting with JMS</h2></div></div></div><p>Citrus provides support for sending and receiving JMS messages. We have to separate between synchronous and asynchronous
    communication. So in this chapter we explain how to setup JMS message senders and receivers for synchronous and asynchronous
    outbound and inbound communication</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Citrus provides a "citrus" configuration namespace and schema definition. Include this namespace into your Spring 
        configuration in order to use the Citrus configuration elements. The namespace URI and schema location are added to the 
        Spring configuration XML file as follows.</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;beans</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">xmlns</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"http://www.springframework.org/schema/beans"</span>
       <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">xmlns:xsi</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">xmlns:citrus</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"http://www.citrusframework.org/schema/config"</span>
       <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">xsi:schemaLocation</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"
       http://www.springframework.org/schema/beans 
       http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://www.citrusframework.org/schema/config 
       http://www.citrusframework.org/schema/config/citrus-config.xsd"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
       
    [...]
    
<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/beans&gt;</span></pre><p>After that you are able to use customized Citrus XML elements in order to define the Spring beans.</p></td></tr></table></div><div class="section" title="11.1.&nbsp;JMS message sender"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jms-sender"></a>11.1.&nbsp;JMS message sender</h2></div></div></div><p>First of all we deal with asynchronous message senders, which means that Citrus is publishing messages to a JMS destination
        (queue or topic). The test case itself does not know about JMS transport details like queue names or connection 
        credentials. This information is stored in the basic Spring configuration. So let us have a look at a simple JMS message sender 
        configuration in Citrus.</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;bean</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">id</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"connectionFactory"</span> 
         <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">class</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"org.apache.activemq.ActiveMQConnectionFactory"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;property</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"brokerURL"</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">value</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"tcp://localhost:61616"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag"> /&gt;</span>
<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/bean&gt;</span>

<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;citrus:jms-message-sender</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">id</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"getOrdersRequestSender"</span> 
                           <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">destination-name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"Citrus.JMS.Order.Queue.Out"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span></pre><p>The JMS connection factory is responsible for connecting to a JMS message broker. In this example we use the Apache ActiveMQ 
        connection factory implementation as we use a ActiveMQ message broker.</p><div class="tip" title="Tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/admons/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>Spring makes it very easy to connect to other JMS broker implementations too (e.g. TIBCO Enterprise Messaging Service, 
            IBM Websphere MQ). Just substitute the implementing class in the connectionFactory bean.</p></td></tr></table></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>All of the JMS senders and receivers that require a reference to a JMS connection factory will automatically look for a bean 
            named "connectionFactory" by default. That is why you don't see a "connection-factory" attribute in many of the examples. 
            However, you can use the "connection-factory" attribute in order to use other connection factory instances with different bean 
            names.</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;citrus:jms-message-sender</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">id</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"getOrdersRequestSender"</span> 
                              <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">destination-name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"Citrus.JMS.Order.Queue.Out"</span>
                              <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">connection-factory</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"myConnectionFacotry"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span></pre><p>Alternatively you may want to directly specify a Spring jmsTemplate.</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;citrus:jms-message-sender</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">id</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"getOrdersRequestSender"</span> 
                            <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">destination-name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"Citrus.JMS.Order.Queue.Out"</span>
                            <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">jms-template</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"myJmsTemplate"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span></pre></td></tr></table></div></div><p>The message sender is now ready for usage inside a test. Many sending actions and test cases reference the message sender. The 
    message sender will simply publish the message to the defined JMS destination. The communication is supposed to be asynchronous, which
    means that the sender will not wait for a synchronous response. The sender fires and forgets the message immediately.</p><div class="section" title="11.2.&nbsp;JMS message receiver"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jms-receiver"></a>11.2.&nbsp;JMS message receiver</h2></div></div></div><p>Now lets deal with receiving an async message over JMS. The message receiver definition is located again in the Spring 
        configuration files. We assume that a connection factory has been configured as shown in the previous section.</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;citrus:jms-message-receiver</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">id</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"getOrdersResponseReceiver"</span> 
                                <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">destination-name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"Citrus.JMS.Order.Queue.In"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span></pre><p> The receiver acts as a message driven listener. This means that the message receiver connects to the given destination 
        and waits for messages to arrive.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Besides the destination-name attribute you can also provide a reference to a Destination implementation.</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;citrus:jms-message-receiver</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">id</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"getOrdersResponseReceiver"</span> 
                                <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">destination</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"orderInboundQueue"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span></pre><p>This destination reference applies to all JMS aware message sender and receiver implementations.</p></td></tr></table></div></div><div class="section" title="11.3.&nbsp;JMS synchronous message sender"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jms-sync-sender"></a>11.3.&nbsp;JMS synchronous message sender</h2></div></div></div><p>When using synchronous message senders Citrus will define a reply-to-queue destination in the message header and wait 
        synchronously for the response on this destination.</p><div class="mediaobject" align="center"><img src="images/figure_006.png" align="middle"></div><p>In the Spring XML configuration the synchronous message senders are quite similar to the asynchronous brothers.</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;citrus:jms-sync-message-sender</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">id</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"getCustomerRequestSender"</span> 
                            <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">destination-name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"Citrus.JMS.Customer.Queue.Out"</span>
                            <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">reply-handler</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"getCustomerReplyHandler"</span>
                            <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">reply-timeout</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"1000"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span>
                            
<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;citrus:jms-reply-message-handler</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">id</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"getCustomerReplyHandler"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span></pre><p>To build synchronous outbound communication we need both a synchronous message sender and a reply handler. Both are defined
        in the Spring configuration. The sender sends the message and waits for the response synchronously. Once the reply has arrived the 
        reply handler is invoked with the respective reply message. The second possibility would be a timeout while receiving the reply.</p><p>See the following figure which tries to explain the handshake between synchronous sender component and synchronous reply handler.
        The synchronous sender receives the reply message and provides it to the reply handler. Once the reply handler has received the reply message 
        it can be handed over to a validator component as usual for extended message validation.</p><div class="mediaobject" align="center"><img src="images/figure_007.png" align="middle"></div><p>The respective test case makes use of both synchronous message sender and reply handler in order to complete the synchronous 
        communication steps.</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;testcase</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"syncMessagingTest"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;actions&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;send</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">with</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"mySyncMessageSender"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
            <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;message&gt;</span>
                <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;data&gt;</span>
                    [...]
                <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/data&gt;</span>
            <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/message&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/send&gt;</span>
        
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;receive</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">with</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"myReplyMessageHandler"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
            <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;message&gt;</span>
                <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;data&gt;</span>
                    [...]
                <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/data&gt;</span>
            <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/message&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/receive&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/actions&gt;</span>
<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/testcase&gt;</span></pre><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The message sender creates a temporary JMS reply destination by default in order to receive the reply. The temporary 
            destination name is stored to the JMS replyTo message header. You can also define a static reply destination like follows.</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;citrus:jms-sync-message-sender</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">id</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"getCustomerRequestSender"</span> 
                <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">destination-name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"Citrus.JMS.Customer.Queue.Out"</span>
                <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">reply-destination-name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"Citrus.JMS.Customer.Queue.Reply"</span>
                <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">reply-handler</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"getCustomerReplyHandler"</span>
                <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">reply-timeout</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"1000"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span></pre><p>Instead of using the <span class="emphasis"><em>reply-destination-name</em></span> feel free to use the destination reference
            <span class="emphasis"><em>reply-destination</em></span></p></td></tr></table></div><div class="important" title="Important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/admons/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>Be aware of permissions that are mandatory for creating temporary destinations. Citrus tries to create temporary queues
          on the JMS message broker. Following from that the Citrus JMS user has to have the permission to do so. 
          Be sure that the user has the sufficient rights when using temporary reply destinations.</p></td></tr></table></div></div><div class="section" title="11.4.&nbsp;JMS synchronous message receiver"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jms-sync-receiver"></a>11.4.&nbsp;JMS synchronous message receiver</h2></div></div></div><p>What is missing is the situation that Citrus receives a JMS message where a temporary reply destination is set.
        When dealing with synchronous JMS communication the requestor will store a dynamic JMS queue destination into the JMS 
        header in order to receive the synchronous answer on this dynamic destination. So Citrus has to send the reply to the 
        temporary destination, which is dynamic of course. You can handle this with the synchronous message receiver in combination 
        with a reply sender.</p><div class="mediaobject" align="center"><img src="images/figure_008.png" align="middle"></div><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;citrus:jms-sync-message-receiver</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">id</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"getOrderRequestReceiver"</span> 
                    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">destination-name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"Citrus.JMS.Order.Queue.In"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span>
                                     
<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;citrus:jms-reply-message-sender</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">id</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"getOrderReplySender"</span>
                    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">reply-destination-holder</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"getOrderRequestReceiver"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span></pre><p>In first sight the synchronous message receiver has no difference to a normal receiver, but the difference comes in
        combination with a synchronous reply sender. The reply sender need to know the dynamic reply destination, so it desires a
        reference to a reply-destination-holder, which is our jms-sync-message-receiver.</p></div><div class="section" title="11.5.&nbsp;JMS Topics"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jms-topics"></a>11.5.&nbsp;JMS Topics</h2></div></div></div><p>Up to now we dealt with JMS queue destinations in this chapter. Citrus is also able to connect to JMS topic destinations.
        In contrary to JMS queues which uses a point-to-point communication JMS topics use publish-subscribe mechanism in order to 
        spread messages over JMS. A JMS topic sender publishes messages to the topic, while the topic accepts multiple message subscriptions and 
        delivers the message to all subscribers.</p><p>The Citrus JMS components (sender/receiver) offer the attribute <span class="emphasis"><em>'pub-sub-domain'</em></span>. Once this attribute
        is set to <span class="emphasis"><em>true</em></span> Citrus will use JMS topics instead of queue destinations. See the following example where the
        publish-subscribe attribute is set to true in JMS message sender and receiver components.</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;citrus:jms-message-sender</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">id</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"helloTopicRequestSender"</span> 
                             <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">destination-name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"Citrus.JMS.Topic.Hello.Request"</span>
                             <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">pub-sub-domain</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"true"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span>

<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;citrus:jms-message-receiver</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">id</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"helloTopicRequestReceiver"</span>
                             <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">receive-timeout</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"5000"</span> 
                             <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">destination-name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"Citrus.JMS.Topic.Hello.Request"</span>
                             <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">pub-sub-domain</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"true"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span></pre><p>When using JMS topics you will be able to subscribe several test actions to the topic destiantion and receive a message
        multiple times as all subscribers will receive the message.</p><div class="important" title="Important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/admons/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>It is very important to keep in mind that Citrus does not deal with durable subscribers, yet. This means that message that were
            sent in advance to the message subscription are not delivered to the message receiver. So racing conditions may cause problems when using
            JMS topic consumers in Citrus. Be sure to let Citrus subscribe to the topic before messages are sent. Otherwise you may loose some messages
            that were sent in advance to the subscription.</p></td></tr></table></div><p>The <span class="emphasis"><em>'pub-sub-domain'</em></span> attribute is also available for synchronous communication sender and receiver 
        components in Citrus. Just add this attribute in order to switch to JMS topics in a publish-subscribe domain.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="xpath.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="http.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;10.&nbsp;Using XPath&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;12.&nbsp;Http Support</td></tr></table></div></body></html>