<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;7.&nbsp;Templates</title><link rel="stylesheet" href="reference-html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="Citrus Framework - Reference Documentation"><link rel="up" href="index.html" title="Citrus Framework - Reference Documentation"><link rel="prev" href="actions.html" title="Chapter&nbsp;6.&nbsp;Test actions"><link rel="next" href="containers.html" title="Chapter&nbsp;8.&nbsp;Containers"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;7.&nbsp;Templates</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="actions.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="containers.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter&nbsp;7.&nbsp;Templates"><div class="titlepage"><div><div><h2 class="title"><a name="templates"></a>Chapter&nbsp;7.&nbsp;Templates</h2></div></div></div><p>Templates group action sequences to a logical unit. You can think of templates as reusable components
    that are used in several tests. The maintenance is much more effective because the templates are referenced
    several times.</p><p>The template always has a unique name. Inside a test case we call the template by this unique name. 
    Have a look at a first example:</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;template</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"doCreateVariables"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;create-variables&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;variable</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"var"</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">value</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"123456789"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/create-variables&gt;</span>
    
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;call-template</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"doTraceVariables"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span>
<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/template&gt;</span>

<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;template</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"doTraceVariables"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;echo&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;message&gt;</span>Current time is: ${time}<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/message&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/echo&gt;</span>
    
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;trace-variables/&gt;</span>
<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/template&gt;</span></pre><p>The code example above describes two template definitions. Templates hold a sequence of test 
    actions or call other templates themselves as seen in the example above.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The &lt;call-template&gt; action calls other templates by their name. The called
      template not necessarily has to be located in the same test case XML file. The template might be defined in
      a separate XML file other than the test case itself:</p></td></tr></table></div><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;testcase</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"templateTest"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;variables&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;variable</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"myTime"</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">value</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"citrus:currentDate()"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/variables&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;actions&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;call-template</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"doCreateVariables"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span>
        
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;call-template</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"doTraceVariables"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
            <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;parameter</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"time"</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">value</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"${myTime}"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/call-template&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/actions&gt;</span>
<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/testcase&gt;</span></pre><p>There is an open question when dealing with templates that are defined somewhere else outside the test case.
    How to handle variables? A templates may use different variable names then the test and vice versa. No doubt the 
    template will fail as soon as special variables with respective values are not present. Unknown variables 
    cause the template and the whole test to fail with errors.</p><p>So a first approach would be to harmonize variable usage across templates and test cases, so that templates
    and test cases do use the same variable naming. But this approach might lead to high calibration effort. Therefore 
    templates support parameters to solve this problem. When a template is called the calling actor is able to set some 
    parameters. Let us discuss an example for this issue.</p><p>The template "doDateCoversion" in the next sample uses the variable ${date}. The calling test case 
    can set this variable as a parameter without actually declaring the variable in the test itself:</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;call-template</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"doDateCoversion"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;parameter</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"date"</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">value</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"${sampleDate}"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/call-template&gt;</span></pre><p>The variable <span class="emphasis"><em>sampleDate</em></span> is already present in the test case and gets translated into the 
    <span class="emphasis"><em>date</em></span> parameter. Following from that the template works fine although test and template do work on 
    different variable namings.</p><p>With template parameters you are able to solve the calibration effort when working with templates and variables. 
    It is always a good idea to check the used variables/parameters inside a template when calling it. There might be a 
    variable that is not declared yet inside your test. So you need to define this value as a parameter.</p><p>Template parameters may contain more complex values like XML fragments. The call-template action offers following 
    CDATA variation for defining complex parameter values:</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;call-template</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"printXMLPayload"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;parameter</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"payload"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;value&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;![CDATA[</span>
          &lt;HelloRequest xmlns="http://www.consol.de/schemas/samples/sayHello.xsd"&gt;
            &lt;Text&gt;Hello South ${var}&lt;/Text&gt;
          &lt;/HelloRequest&gt;
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">]]&gt;</span>
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/value&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/parameter&gt;</span>
<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/call-template&gt;</span></pre><div class="important" title="Important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/admons/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>When a template works on variable values and parameters changes to these variables will automatically affect the variables 
        in the whole test. So if you change a variable's value inside a template and the variable is defined inside the test case the
        changes will affect the variable in a global context. We have to be careful with this when executing a template several
        times in a test, especially in combination with parallel containers (see <a class="xref" href="containers.html#containers-parallel" title="8.2.&nbsp;Parallel">Section&nbsp;8.2, &#8220;Parallel&#8221;</a>).</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;parallel&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;call-template</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"print"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;parameter</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"param1"</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">value</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"1"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;parameter</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"param2"</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">value</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"Hello Europe"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/call-template&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;call-template</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"print"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;parameter</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"param1"</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">value</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"2"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;parameter</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"param2"</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">value</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"Hello Asia"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/call-template&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;call-template</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"print"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;parameter</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"param1"</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">value</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"3"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;parameter</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"param2"</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">value</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"Hello Africa"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">/&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/call-template&gt;</span>
<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/parallel&gt;</span></pre><p>In the listing above a template <span class="emphasis"><em>print</em></span> is called several times in a parallel container. The parameter values
        will be handled in a global context, so it is quite likely to happen that the template instances influence each other during execution.
        We might get such print messages:</p><pre class="programlisting">2. Hello Europe
2. Hello Africa
3. Hello Africa</pre><p>Index parameters do not fit and the message <span class="emphasis"><em>'Hello Asia'</em></span> is completely gone. This is because templates 
        overwrite parameters to each other as they are executed in parallel at the same time. To avoid this behavior we need to tell the template 
        that it should handle parameters as well as variables in a local context. This will enforce that each template instance is working on a 
        dedicated local context. See the <span class="emphasis"><em>global-context</em></span> attribute that is set to <span class="emphasis"><em>false</em></span> in this example:</p><pre class="programlisting"><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;template</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">name</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"print"</span> <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-attribute">global-context</span>=<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-value">"false"</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;echo&gt;</span>
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;message&gt;</span>${param1}.${param2}<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/message&gt;</span>
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/echo&gt;</span>
<span xmlns="http://www.w3.org/TR/xhtml1/transitional" class="hl-tag">&lt;/template&gt;</span></pre><p>After that template instances won't influence each other anymore. But notice that variable changes inside the template then do not affect 
        the test case neither.</p></td></tr></table></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="actions.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="containers.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;6.&nbsp;Test actions&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;8.&nbsp;Containers</td></tr></table></div></body></html>